{% extends "base.html" %}{% load static %}
{% block title %}Calendario presenze &raquo; {{ block.super }}{% endblock %}
{% block content %}
	<h1>Calendario presenze</h1>
	<form method="get" action="">
		<label for="day">Scegli il giorno</label>
		<input id="day" name="day" type="text" class="datepicker"
			   value='{{ day|date:"d/m/Y" }}'/>
		<input id='changeday_submit' type="submit" value="vedi calendario"/>
	</form>
	{% include "calendar/new_caltoken.html" %}
	<div id="calendar_man">
		{% for calType, calDesc in calendars.items %}
			{#			<h2>{{ calDesc.name }}</h2>#}
			{% if calDesc.elements or True %}
				<table id='{{ calType }}' class="calendar tablesorter {{ calDesc.tags }}">
					<thead>
					<tr>
						<th>Conducente in {{ calDesc.name }}</th>
						<th>orario</th>
						<th>durata</th>
					</tr>
					</thead>
					<tbody>
					{% for element in calDesc.elements %}
						<tr>
							<td>{{ element.conducente.nome }}</td>
							<td>
								{% with d=element.date_start %}
									{% if d < day %}
										{{ d|date:"d/M/Y H:i" }}
									{% else %}
										{{ d|date:"H:i" }}
									{% endif %}
								{% endwith %}
							-
								{% with d=element.date_end %}
									{% if d > nextday %}
										{{ d|date:"d/M/Y H:i" }}
									{% else %}
										{{ d|date:"H:i" }}
									{% endif %}
								{% endwith %}
							</td>
							<td>
								{{ element.pretty_duration }}
								<span class="del"><a data-id="{{ element.id }}" href="#">elimina</a></span>
							</td>
						</tr>
					{% endfor %}
					</tbody>
				</table>
			{% else %}
				Nessun evento in calendario.
			{% endif %}
		{% endfor %}
	</div>
{% endblock %}

{% block bottom %}
	<script src="{% static 'js/timeWidgets.js' %}"></script>
	<script src="{% static 'js/calendarioPresenze.js' %}"></script>
{% endblock bottom %}
